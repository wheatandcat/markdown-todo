sh ./scripts/build-electron.sh
üî® Building Electron macOS app...
üîß Fixing package.json dependencies...
üîß Fixing package.json for Electron build...
‚úÖ Package.json fixed for build
üì¶ Building web application...

> smart-task-manager@1.0.0 build
> vite build && esbuild server/index.ts --platform=node --packages=external --bundle --format=esm --outdir=dist

‚úò [ERROR] Top-level await is currently not supported with the "cjs" output format

    vite.config.ts:13:10:
      13 ‚îÇ           await import("@replit/vite-plugin-cartographer").then((m) =>
         ‚ïµ           ~~~~~

‚úò [ERROR] "@replit/vite-plugin-runtime-error-modal" resolved to an ESM file. ESM file cannot be loaded by `require`. See https://vite.dev/guide/troubleshooting.html#this-package-is-esm-only for more details. [plugin externalize-deps]

    node_modules/vite/node_modules/esbuild/lib/main.js:1225:27:
      1225 ‚îÇ         let result = await callback({
           ‚ïµ                            ^

    at file:///Users/iinoyouhei/go/src/github.com/markdown-todo/node_modules/vite/dist/node/chunks/dep-CHZK6zbr.js:66819:23
    at requestCallbacks.on-resolve (/Users/iinoyouhei/go/src/github.com/markdown-todo/node_modules/vite/node_modules/esbuild/lib/main.js:1225:28)
    at handleRequest (/Users/iinoyouhei/go/src/github.com/markdown-todo/node_modules/vite/node_modules/esbuild/lib/main.js:647:17)
    at handleIncomingPacket (/Users/iinoyouhei/go/src/github.com/markdown-todo/node_modules/vite/node_modules/esbuild/lib/main.js:672:7)
    at Socket.readFromStdout (/Users/iinoyouhei/go/src/github.com/markdown-todo/node_modules/vite/node_modules/esbuild/lib/main.js:600:7)
    at Socket.emit (node:events:518:28)
    at addChunk (node:internal/streams/readable:559:12)
    at readableAddChunkPushByteMode (node:internal/streams/readable:510:3)
    at Readable.push (node:internal/streams/readable:390:5)
    at Pipe.onStreamRead (node:internal/stream_base_commons:190:23)

  This error came from the "onResolve" callback registered here:

    node_modules/vite/node_modules/esbuild/lib/main.js:1150:20:
      1150 ‚îÇ       let promise = setup({
           ‚ïµ                     ^

    at setup (file:///Users/iinoyouhei/go/src/github.com/markdown-todo/node_modules/vite/dist/node/chunks/dep-CHZK6zbr.js:66781:18)
    at handlePlugins (/Users/iinoyouhei/go/src/github.com/markdown-todo/node_modules/vite/node_modules/esbuild/lib/main.js:1150:21)
    at buildOrContextImpl (/Users/iinoyouhei/go/src/github.com/markdown-todo/node_modules/vite/node_modules/esbuild/lib/main.js:873:5)
    at Object.buildOrContext (/Users/iinoyouhei/go/src/github.com/markdown-todo/node_modules/vite/node_modules/esbuild/lib/main.js:699:5)
    at /Users/iinoyouhei/go/src/github.com/markdown-todo/node_modules/vite/node_modules/esbuild/lib/main.js:2023:15
    at new Promise (<anonymous>)
    at Object.build (/Users/iinoyouhei/go/src/github.com/markdown-todo/node_modules/vite/node_modules/esbuild/lib/main.js:2022:25)
    at build (/Users/iinoyouhei/go/src/github.com/markdown-todo/node_modules/vite/node_modules/esbuild/lib/main.js:1873:51)
    at bundleConfigFile (file:///Users/iinoyouhei/go/src/github.com/markdown-todo/node_modules/vite/dist/node/chunks/dep-CHZK6zbr.js:66736:24)

  The plugin "externalize-deps" was triggered by this import

    vite.config.ts:4:32:
      4 ‚îÇ import runtimeErrorOverlay from "@replit/vite-plugin-runtime-error-modal";
        ‚ïµ                                 ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~

failed to load config from /Users/iinoyouhei/go/src/github.com/markdown-todo/vite.config.ts
error during build:
Error: Build failed with 2 errors:
node_modules/vite/node_modules/esbuild/lib/main.js:1225:27: ERROR: [plugin: externalize-deps] "@replit/vite-plugin-runtime-error-modal" resolved to an ESM file. ESM file cannot be loaded by `require`. See https://vite.dev/guide/troubleshooting.html#this-package-is-esm-only for more details.
vite.config.ts:13:10: ERROR: Top-level await is currently not supported with the "cjs" output format
    at failureErrorWithLog (/Users/iinoyouhei/go/src/github.com/markdown-todo/node_modules/vite/node_modules/esbuild/lib/main.js:1472:15)
    at /Users/iinoyouhei/go/src/github.com/markdown-todo/node_modules/vite/node_modules/esbuild/lib/main.js:945:25
    at runOnEndCallbacks (/Users/iinoyouhei/go/src/github.com/markdown-todo/node_modules/vite/node_modules/esbuild/lib/main.js:1315:45)
    at buildResponseToResult (/Users/iinoyouhei/go/src/github.com/markdown-todo/node_modules/vite/node_modules/esbuild/lib/main.js:943:7)
    at /Users/iinoyouhei/go/src/github.com/markdown-todo/node_modules/vite/node_modules/esbuild/lib/main.js:970:16
    at responseCallbacks.<computed> (/Users/iinoyouhei/go/src/github.com/markdown-todo/node_modules/vite/node_modules/esbuild/lib/main.js:622:9)
    at handleIncomingPacket (/Users/iinoyouhei/go/src/github.com/markdown-todo/node_modules/vite/node_modules/esbuild/lib/main.js:677:12)
    at Socket.readFromStdout (/Users/iinoyouhei/go/src/github.com/markdown-todo/node_modules/vite/node_modules/esbuild/lib/main.js:600:7)
    at Socket.emit (node:events:518:28)
    at addChunk (node:internal/streams/readable:559:12)
‚ùå Web app build failed